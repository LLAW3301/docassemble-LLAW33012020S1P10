# The main program that controls the execution
---
include:
  - P10_RSB_Section1.yml
  - P10_RSB_Section2.yml
  - P10_RSB_Section3.yml
---
metadata:
  title: |
    <span class="P10_title_style"> RSB Service Agreement Facilitator
    </span>
---
features:
  css: P10_RSB2_Smed0013.css
---
objects:
  - P10Icon: DAStaticFile.using(filename='P10_RSB2_Icon.png')
---
mandatory: True
code: |
  set_parts(logo='<img src="' + P10Icon.url_for() + '" style="height: 60px; margin-left: 10px;">')
---
mandatory: True
question: |
  <span class="P10_question_style">
  Welcome to The Royal Society for the Blind - NDIS Service Agreement Application
  </span>
subquestion: |
  Disclaimer: This application will request information from you and   automatically fill in a NDIS Service Agreement. The completed application will then be automastically emailed to The Royal Society for the Blind, and allow you to download a PDF copy. Should you disagree with any of the terms or have any questions, this application will refer you to the contact page of The Royal Society of the Blind so that you can make contact with a Case Manager.

  To get started, press **Continue**.
  To contact us, press **exit**
buttons:
  - Continue: continue
  - Exit and Contact Us: exit
    url: https://rsb.org.au/contact-us
---
# This code block controls the execution of the program
mandatory: True
code: |
  P10Name
  P10Representative
  P10CaseManager
  P10Date
  if not P10ScheduleOfServices or not P10ResponsibilitiesOfRSB or not     P10ResponsibilitiesOfParticipant or not P10Payments:
    exit_endpoint
  P10payment_method
  P10Payment_date
  if not P10Changes or not P10RefusalToSign or not P10Feedback or not P10Contact or not P10Incidents:
    exit_endpoint
  P10_phonenumber
  P10_mobilenumber
  P10_emailaddress
  P10_homeaddress
  if not P10Acceptance:
    exit_endpoint
  P10_signature
  P10_signedname
  P10_signeddate  
--- 
#### final page of interview 
mandatory: True
question: |
subquestion: |
  
  Thankyou for your time, your completed and signed service aggrement will be    fowarded to your case manager.
  
  By entering your email below you can recieve a personal copy of this agreement via email.  
  
  Feel free to contact your case manager if you have any further questions.
  
  **RSBâ€™s contact details:**
  Phone number: 1300 944 306 
  Email address: ndis@rsb.org.au
  Business Address: 230 Pirie St, Adelaide, 5000.

attachment:
  docx template file: Revised_Service_Agreement_with_Jinja_2.docx
  valid formats:
  - PDF 
buttons:
  - I'm done: exit
---
code: |
send_email: (to= 'gall0166@flinders.edu.au', template=notification, attachments [Revised_Service_Agreement_with_Jinja_2.docx])
---
template: notification
subject: |
  Hello ${{ P10CaseManager }}
content: |
  This is an automated e-mail sent from an interview with a
  client, ${{ P10Name }} Attached you will find their signed service aggreement.
 
  Have a nice day!
attachment:
  variable name: service_agreement
  docx template file: Revised_Service_Agreement_with_Jinja_2.docx
  valid formats:
    - pdf
---
  